model ConcessionApplication {
  id                String                      @id @default(uuid())
  applicationType   ConcessionApplicationType
  status            ConcessionApplicationStatus
  approvedAt        DateTime?
  validFrom         DateTime?
  validTo           DateTime?
  bookletPageNumber Int
  applicationNumber String
  serialNumber      String

  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  updatedBy String

  studentUserId       String
  student             Student           @relation(fields: [studentUserId], references: [userId])
  concessionClassId   String
  concessionClass     ConcessionClass   @relation(fields: [concessionClassId], references: [id])
  approvedByAdminId   String
  approvedBy          Admin             @relation(fields: [approvedByAdminId], references: [userId])
  fromStationId       String
  fromStation         Station           @relation(fields: [fromStationId], references: [id])
  concessionPeriodId  String
  concessionPeriod    ConcessionPeriod  @relation(fields: [concessionPeriodId], references: [id])
  concessionBookletId String
  concessionBooklet   ConcessionBooklet @relation(fields: [concessionBookletId], references: [id])

  nextConcessionId   String?                @unique
  nextConcession     ConcessionApplication? @relation("ConcessionHistory", fields: [nextConcessionId], references: [id])
  previousConcession ConcessionApplication? @relation("ConcessionHistory")
}

model ConcessionPeriod {
  id       String @id @default(uuid())
  code     String
  duration Int

  isActive    Boolean
  isDeleted   Boolean
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  updatedById String?
  updatedBy   User?    @relation(fields: [updatedById], references: [id])

  applications ConcessionApplication[]
}

model ConcessionBooklet {
  id                String                  @id @default(uuid())
  bookletNumber     Int
  serialStartNumber String
  serialEndNumber   String
  totalPage         Int
  usedPages         Int
  status            ConcessionBookletStatus

  isActive    Boolean
  isDeleted   Boolean
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  updatedById String?
  updatedBy   User?    @relation(fields: [updatedById], references: [id])

  applications ConcessionApplication[]
}

model ConcessionClass {
  id   String @id @default(uuid())
  name String
  code String

  isActive    Boolean
  isDeleted   Boolean
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  updatedById String?
  updatedBy   User?    @relation(fields: [updatedById], references: [id])

  applications ConcessionApplication[]
}

model Station {
  id          String @id @default(uuid())
  name        String
  code        String
  state       String
  addressLine String
  area        String
  pincode     Int

  isActive    Boolean
  isDeleted   Boolean
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  updatedById String?
  updatedBy   User?    @relation(fields: [updatedById], references: [id])

  applications ConcessionApplication[]
}
