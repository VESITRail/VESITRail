model Student {
  firstName          String
  middleName         String
  lastName           String
  address            String
  gender             Gender
  verificationDocUrl String
  dateOfBirth        DateTime
  approvalStatus     StudentApprovalStatus

  updatedAt DateTime @updatedAt
  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())

  classId                     String
  stationId                   String
  preferredConcessionClassId  String
  preferredConcessionPeriodId String
  userId                      String @id

  AddressChange         AddressChange[]
  ConcessionApplication ConcessionApplication[]

  class                     Class            @relation(fields: [classId], references: [id])
  station                   Station          @relation(fields: [stationId], references: [id])
  user                      User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  preferredConcessionClass  ConcessionClass  @relation("StudentPreferredClass", fields: [preferredConcessionClassId], references: [id])
  preferredConcessionPeriod ConcessionPeriod @relation("StudentPreferredPeriod", fields: [preferredConcessionPeriodId], references: [id])
}

model Class {
  id   String @id @default(uuid())
  code String @unique

  updatedAt DateTime @updatedAt
  isActive  Boolean  @default(true)
  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())

  yearId   String
  branchId String

  students Student[]
  year     Year      @relation(fields: [yearId], references: [id])
  branch   Branch    @relation(fields: [branchId], references: [id])
}

model Branch {
  id   String @id @default(uuid())
  code String @unique
  name String @unique

  updatedAt DateTime @updatedAt
  isActive  Boolean  @default(true)
  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())

  classes Class[]
}

model Year {
  id   String @id @default(uuid())
  name String @unique

  updatedAt DateTime @updatedAt
  isActive  Boolean  @default(true)
  isDeleted Boolean  @default(false)
  createdAt DateTime @default(now())

  classes Class[]
}

model AddressChange {
  id        String @id @default(uuid())
  studentId String

  newAddress   String
  newStationId String

  currentAddress   String
  currentStationId String

  verificationDocUrl String
  status             AddressChangeStatus @default(Pending)

  reviewedBy String?
  reviewedAt DateTime?
  updatedAt  DateTime  @updatedAt
  createdAt  DateTime  @default(now())

  student        Student @relation(fields: [studentId], references: [userId])
  newStation     Station @relation("NewStation", fields: [newStationId], references: [id])
  currentStation Station @relation("CurrentStation", fields: [currentStationId], references: [id])
}
